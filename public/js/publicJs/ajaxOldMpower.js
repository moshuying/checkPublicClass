function MdownloadInfoBeforeOld(){
    var download = document.getElementsByTagName('select')[0];
    var xhr = new XMLHttpRequest(),
        url = '../ajax/ajaxMDownloadClassHumanBefore.php',
        className = download.value;
    xhr.open('GET', url + "?className=" + className, !0);
    xhr.send();
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && (xhr.status == 200 || xhr.status == 304)) {
            var jsonDATA = eval(this.responseText);
            console.log(jsonDATA[0].ID);
            MdownloadInfoOld(className,jsonDATA[0].ID,jsonDATA[0].author,jsonDATA[0].number);
        }
    }
}
function MdownloadInfoOld(className,classID,author,number) {
    var xhr = new XMLHttpRequest(),
        url = '../ajax/ajaxMDownloadClassHuman.php',
        fileName = className + "学生信息";
    xhr.open('GET', url + "?classID=" + classID, !0);
    xhr.send();
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && (xhr.status == 200 || xhr.status == 304)) {
            var jsonDATA = eval(this.responseText);
            // console.log(jsonDATA[2]['username']);
            JSONToExcelConvertorOld(jsonDATA, fileName,author,number);
        }
    }

}

//写入excel(jsonData主体字符串,生成的文件名,主讲人,课程人数 )
function JSONToExcelConvertorOld(JSONData, FileName, author,number) {
    //先转化json
    var arrData = JSONData; //typeof JSONData != 'object' ? JSON.parse(JSONData) : JSONData;
    var excel='';
    //不需要表头部分
    // var excel = '<table><thead>';
    //设置表头 
        // var row = "<tr>";
        // for (var i in ShowLabel) {
        //     row += "<td>" + ShowLabel[i] + '</td>';
        // }
        // //换行 
        // excel += row + "</tr>";
        // //设置数据 
    for (var i in arrData) {
        // if(arrData[i].username==null||arrData[i].username=="") break;
        var row = '<tr height="18" style="height:13.50pt;">';
        // for (var index in arrData[i]) { 
        //  var value = arrData[i][index].value === "." ? "" : arrData[i][index].value;
        //     row += '<td>' + value + '</td>'; 
        // } 
        // for (var index in arrData[i]) {
        var value="";
        var num=Number(i) + Number(1);
        value += '<td class="xl73" height="18" style="height:13.50pt;" x:num>' + num  + "</td>";
        value += '<td class="xl73" x:str>' + arrData[i]['username']  + "</td>";
        value += '<td class="xl76" x:str>' + arrData[i]['xingming']  + "</td>";
        value += '<td class="xl77" x:str>' + arrData[i]['banji']     + "</td>";
        value += '<td class="xl76" x:str>' + arrData[i]['zhuanye']   + "</td>";
        for(var x=0;x<19;x++){
            value+='<td class="xl78"></td>';
        }
        row += value;

        excel += row + "</tr>";
    }
    //时间戳
    function TimesTempToTime() { var date = new Date(Date.now());var Y = date.getFullYear() + '-'; var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-'; var D = date.getDate() < 10 ? '0'+date.getDate()+ ' ' : date.getDate()+ ' '; var h = date.getHours() < 10 ? '0'+date.getHours()+ ':' : date.getHours()+ ':'; var m = date.getMinutes() < 10 ? '0'+date.getMinutes()+ ':' : date.getMinutes()+ ':'; var s = date.getSeconds()< 10 ? '0'+date.getSeconds() : date.getSeconds(); return Y+M+D+h+m+s; } 
    var times=TimesTempToTime();
    excel += "</table>";
    var excelFile = `<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="ProgId" content="Excel.Sheet"/><meta name="Generator" content="WPS Office ET"/><!--[if gte mso 9]><xml><o:DocumentProperties><o:Created>`;
    excelFile+=times+`</o:Created><o:LastAuthor>西南科技大学城市学院 墨抒颖</o:LastAuthor><o:LastSaved>`+times+`</o:LastSaved></o:DocumentProperties><o:CustomDocumentProperties><o:KSOProductBuildVer dt:dt="string">2052-11.1.0.8527</o:KSOProductBuildVer></o:CustomDocumentProperties></xml><![endif]--><style>@page{margin:1in .75in 1in .75in;mso-header-margin:.5in;mso-footer-margin:.5in}tr{mso-height-source:auto;mso-ruby-visibility:none}col{mso-width-source:auto;mso-ruby-visibility:none}br{mso-data-placement:same-cell}.font0{color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font1{color:#000;font-size:16pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"Arial Unicode MS";mso-generic-font-family:auto;mso-font-charset:134}.font2{color:#000;font-size:9.8pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"Arial Unicode MS";mso-generic-font-family:auto;mso-font-charset:134}.font3{color:#000;font-size:10pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"Times New Roman";mso-generic-font-family:auto;mso-font-charset:134}.font4{color:#000;font-size:10pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"Arial Unicode MS";mso-generic-font-family:auto;mso-font-charset:134}.font5{color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font6{color:#fff;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font7{color:#44546a;font-size:13pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font8{color:red;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font9{color:#7f7f7f;font-size:11pt;font-weight:400;font-style:italic;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font10{color:#44546a;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font11{color:purple;font-size:11pt;font-weight:400;font-style:normal;text-decoration:underline;text-underline-style:single;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font12{color:#9c0006;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font13{color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font14{color:#3f3f3f;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font15{color:#44546a;font-size:15pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font16{color:#000;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font17{color:#44546a;font-size:18pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font18{color:#00f;font-size:11pt;font-weight:400;font-style:normal;text-decoration:underline;text-underline-style:single;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:134}.font19{color:#9c6500;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font20{color:#3f3f76;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font21{color:#006100;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font22{color:#fa7d00;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.font23{color:#fa7d00;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:"宋体";mso-generic-font-family:auto;mso-font-charset:0}.style0{mso-number-format:General;text-align:general;vertical-align:middle;white-space:nowrap;mso-rotate:0;mso-pattern:auto;mso-background-source:auto;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;border:none;mso-protection:locked visible;mso-style-name:"常规";mso-style-id:0}.style16{mso-number-format:"_ \\0022\\00A5\\0022* \\#\\,\\#\\#0_ \\;_ \\0022\\00A5\\0022* \\\\-\\#\\,\\#\\#0_ \\;_ \\0022\\00A5\\0022* \\0022-\\0022_ \\;_ \\@_ ";mso-style-name:"货币[0]";mso-style-id:7}.style17{mso-pattern:auto none;background:#ededed;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"20% - 强调文字颜色 3"}.style18{mso-pattern:auto none;background:#fc9;color:#3f3f76;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;border:.5pt solid #7f7f7f;mso-style-name:"输入"}.style19{mso-number-format:"_ \\0022\\00A5\\0022* \\#\\,\\#\\#0\\.00_ \\;_ \\0022\\00A5\\0022* \\\\-\\#\\,\\#\\#0\\.00_ \\;_ \\0022\\00A5\\0022* \\0022-\\0022??_ \\;_ \\@_ ";mso-style-name:"货币";mso-style-id:4}.style20{mso-number-format:"_ * \\#\\,\\#\\#0_ \\;_ * \\\\-\\#\\,\\#\\#0_ \\;_ * \\0022-\\0022_ \\;_ \\@_ ";mso-style-name:"千位分隔[0]";mso-style-id:6}.style21{mso-pattern:auto none;background:#dbdbdb;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"40% - 强调文字颜色 3"}.style22{mso-pattern:auto none;background:#ffc7ce;color:#9c0006;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"差"}.style23{mso-number-format:"_ * \\#\\,\\#\\#0\\.00_ \\;_ * \\\\-\\#\\,\\#\\#0\\.00_ \\;_ * \\0022-\\0022??_ \\;_ \\@_ ";mso-style-name:"千位分隔";mso-style-id:3}.style24{mso-pattern:auto none;background:#c9c9c9;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"60% - 强调文字颜色 3"}.style25{color:#00f;font-size:11pt;text-decoration:underline;text-underline-style:single;font-family:宋体;mso-style-name:"超链接";mso-style-id:8}.style26{mso-number-format:"0%";mso-style-name:"百分比";mso-style-id:5}.style27{color:purple;font-size:11pt;text-decoration:underline;text-underline-style:single;font-family:宋体;mso-style-name:"已访问的超链接";mso-style-id:9}.style28{mso-pattern:auto none;background:#ffc;border:.5pt solid #b2b2b2;mso-style-name:"注释"}.style29{mso-pattern:auto none;background:#f4b084;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"60% - 强调文字颜色 2"}.style30{color:#44546a;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;mso-style-name:"标题 4"}.style31{color:red;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"警告文本"}.style32{color:#44546a;font-size:18pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;mso-style-name:"标题"}.style33{color:#7f7f7f;font-size:11pt;font-weight:400;font-style:italic;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"解释性文本"}.style34{color:#44546a;font-size:15pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;border-bottom:1pt solid #5b9bd5;mso-style-name:"标题 1"}.style35{color:#44546a;font-size:13pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;border-bottom:1pt solid #5b9bd5;mso-style-name:"标题 2"}.style36{mso-pattern:auto none;background:#9bc2e6;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"60% - 强调文字颜色 1"}.style37{color:#44546a;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;border-bottom:1pt solid #acccea;mso-style-name:"标题 3"}.style38{mso-pattern:auto none;background:#ffd966;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"60% - 强调文字颜色 4"}.style39{mso-pattern:auto none;background:#f2f2f2;color:#3f3f3f;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;border:.5pt solid #3f3f3f;mso-style-name:"输出"}.style40{mso-pattern:auto none;background:#f2f2f2;color:#fa7d00;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;border:.5pt solid #7f7f7f;mso-style-name:"计算"}.style41{mso-pattern:auto none;background:#a5a5a5;color:#fff;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;border:2pt double #3f3f3f;mso-style-name:"检查单元格"}.style42{mso-pattern:auto none;background:#e2efda;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"20% - 强调文字颜色 6"}.style43{mso-pattern:auto none;background:#ed7d31;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"强调文字颜色 2"}.style44{color:#fa7d00;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;border-bottom:2pt double #ff8001;mso-style-name:"链接单元格"}.style45{color:#000;font-size:11pt;font-weight:700;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;border-top:.5pt solid #5b9bd5;border-bottom:2pt double #5b9bd5;mso-style-name:"汇总"}.style46{mso-pattern:auto none;background:#c6efce;color:#006100;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"好"}.style47{mso-pattern:auto none;background:#ffeb9c;color:#9c6500;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"适中"}.style48{mso-pattern:auto none;background:#d9e1f2;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"20% - 强调文字颜色 5"}.style49{mso-pattern:auto none;background:#5b9bd5;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"强调文字颜色 1"}.style50{mso-pattern:auto none;background:#ddebf7;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"20% - 强调文字颜色 1"}.style51{mso-pattern:auto none;background:#bdd7ee;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"40% - 强调文字颜色 1"}.style52{mso-pattern:auto none;background:#fce4d6;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"20% - 强调文字颜色 2"}.style53{mso-pattern:auto none;background:#f8cbad;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"40% - 强调文字颜色 2"}.style54{mso-pattern:auto none;background:#a5a5a5;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"强调文字颜色 3"}.style55{mso-pattern:auto none;background:#ffc000;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"强调文字颜色 4"}.style56{mso-pattern:auto none;background:#fff2cc;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"20% - 强调文字颜色 4"}.style57{mso-pattern:auto none;background:#ffe699;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"40% - 强调文字颜色 4"}.style58{mso-pattern:auto none;background:#4472c4;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"强调文字颜色 5"}.style59{mso-pattern:auto none;background:#b4c6e7;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"40% - 强调文字颜色 5"}.style60{mso-pattern:auto none;background:#8ea9db;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"60% - 强调文字颜色 5"}.style61{mso-pattern:auto none;background:#70ad47;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"强调文字颜色 6"}.style62{mso-pattern:auto none;background:#c6e0b4;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"40% - 强调文字颜色 6"}.style63{mso-pattern:auto none;background:#a9d08e;color:#fff;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:0;mso-style-name:"60% - 强调文字颜色 6"}td{mso-style-parent:style0;padding-top:1px;padding-right:1px;padding-left:1px;mso-ignore:padding;mso-number-format:General;text-align:general;vertical-align:middle;white-space:nowrap;mso-rotate:0;mso-pattern:auto;mso-background-source:auto;color:#000;font-size:11pt;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;mso-generic-font-family:auto;mso-font-charset:134;border:none;mso-protection:locked visible}.xl65{mso-style-parent:style0;text-align:center;mso-font-charset:134}.xl66{mso-style-parent:style0;text-align:center;white-space:normal;font-size:16pt;font-weight:700;font-family:Arial Unicode MS;mso-font-charset:134}.xl67{mso-style-parent:style0;text-align:center;white-space:normal;font-size:16pt;font-weight:700;font-family:Arial Unicode MS;mso-font-charset:134}.xl68{mso-style-parent:style0;text-align:center;white-space:normal;font-size:9.8pt;font-weight:700;font-family:Arial Unicode MS;mso-font-charset:134}.xl69{mso-style-parent:style0;text-align:center;white-space:normal;font-size:9.8pt;font-weight:700;font-family:Arial Unicode MS;mso-font-charset:134}.xl70{mso-style-parent:style0;white-space:normal;font-size:10pt;font-family:Times New Roman;mso-font-charset:134}.xl71{mso-style-parent:style0;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134}.xl72{mso-style-parent:style0;text-align:center;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134}.xl73{mso-style-parent:style0;text-align:center;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134;border:.5pt solid windowtext}.xl74{mso-style-parent:style0;text-align:center;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134;border-left:.5pt solid windowtext;border-top:.5pt solid windowtext;border-right:.5pt solid windowtext}.xl75{mso-style-parent:style0;text-align:center;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134;border-left:.5pt solid windowtext;border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext}.xl76{mso-style-parent:style0;text-align:left;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134;border:.5pt solid windowtext}.xl77{mso-style-parent:style0;text-align:center;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134;border:.5pt solid windowtext}.xl78{mso-style-parent:style0;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134;border:.5pt solid windowtext}.xl79{mso-style-parent:style0;white-space:normal;font-size:10pt;font-family:Arial Unicode MS;mso-font-charset:134}</style><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>2019_4_12</x:Name><x:WorksheetOptions><x:DefaultRowHeight>270</x:DefaultRowHeight><x:Selected/><x:Panes><x:Pane><x:Number>3</x:Number><x:ActiveCol>26</x:ActiveCol><x:ActiveRow>14</x:ActiveRow><x:RangeSelection>AA15</x:RangeSelection></x:Pane></x:Panes><x:DoNotDisplayGridlines/><x:ProtectContents>False</x:ProtectContents><x:ProtectObjects>False</x:ProtectObjects><x:ProtectScenarios>False</x:ProtectScenarios><x:Print><x:PaperSizeIndex>9</x:PaperSizeIndex></x:Print></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets><x:ProtectStructure>False</x:ProtectStructure><x:ProtectWindows>False</x:ProtectWindows><x:WindowHeight>13065</x:WindowHeight><x:WindowWidth>27870</x:WindowWidth></x:ExcelWorkbook></xml><![endif]--></head><body link="blue" vlink="purple"><table width="729.53" border="0" cellpadding="0" cellspacing="0" style='width:547.15pt;border-collapse:collapse;table-layout:fixed;'><col width="37" style='mso-width-source:userset;mso-width-alt:1184;'/><col width="89" style='mso-width-source:userset;mso-width-alt:2848;'/><col width="50" style='mso-width-source:userset;mso-width-alt:1600;'/><col width="50" class="xl65" style='mso-width-source:userset;mso-width-alt:1600;'/><col width="65" style='mso-width-source:userset;mso-width-alt:2080;'/><col width="18" span="3" style='mso-width-source:userset;mso-width-alt:576;'/><col width="30.07" span="8" style='mso-width-source:userset;mso-width-alt:962;'/><col width="18" span="8" style='mso-width-source:userset;mso-width-alt:576;'/><tr height="27" style='height:20.25pt;mso-height-source:userset;mso-height-alt:405;'><td class="xl66" height="27" width="729.53" colspan="24" style='height:20.25pt;width:547.15pt;border-right:none;border-bottom:none;' x:str>` ;
    //点名册名字
    excelFile += `西南科技大学城市学院上课点名册`+`</td></tr><tr height="18" style='height:13.50pt;mso-height-source:userset;mso-height-alt:270;'><td class="xl68" height="18" colspan="24" style='height:13.50pt;border-right:none;border-bottom:none;' x:str>`;
    //学期号
    excelFile += `2018-2019学年第二学期`+`</td></tr><tr height="18" style='height:13.50pt;mso-height-source:userset;mso-height-alt:270;'><td class="xl70" height="18" colspan="8" style='height:13.50pt;border-right:none;border-bottom:none;' x:str> <font class="font4">承担单位：工程技术学院</font></td><td class="xl79" colspan="8" style='border-right:none;border-bottom:none;' x:str>课<font class="font3">    </font><font class="font4">程：`;
    //课程名字
    excelFile += FileName+`</font></td><td class="xl71" colspan="8" style='border-right:none;border-bottom:none;'></td></tr><tr height="18" style='height:13.50pt;mso-height-source:userset;mso-height-alt:270;'><td class="xl70" height="18" colspan="8" style='height:13.50pt;border-right:none;border-bottom:none;' x:str> <font class="font4">任课教师：`;
    //主讲人
    excelFile += author+`</font></td><td class="xl71" colspan="8" style='border-right:none;border-bottom:none;' x:str>上课人数：`;
    //课程人数
    excelFile += number+`</td><td class="xl71" colspan="8" style='border-right:none;border-bottom:none;'></td></tr><tr height="18" style='height:13.50pt;mso-height-source:userset;mso-height-alt:270;'><td class="xl73" height="36" rowspan="2" style='height:27.00pt;border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext;' x:str>序号</td><td class="xl73" rowspan="2" style='border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext;' x:str>学号</td><td class="xl73" rowspan="2" style='border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext;' x:str>姓名</td><td class="xl74" rowspan="2" style='border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext;' x:str>专业</td><td class="xl73" rowspan="2" style='border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext;' x:str>行政班级</td><td class="xl73" colspan="19" style='border-right:.5pt solid windowtext;border-bottom:.5pt solid windowtext;' x:str>日期周次</td></tr><tr height="18" style='height:13.50pt;'><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td><td class="xl73"></td></tr>`;
    //文件主体
    excelFile += excel;
    //文件结尾
    excelFile +=`<![if supportMisalignedColumns]><tr width="0" style='display:none;'><td width="37" style='width:28;'></td><td width="89" style='width:67;'></td><td width="50" style='width:38;'></td><td width="50" style='width:38;'></td><td width="65" style='width:49;'></td><td width="18" style='width:14;'></td><td width="30" style='width:23;'></td><td width="18" style='width:14;'></td></tr><![endif]></table></body></html>`;
    var uri = 'data:application/vnd.ms-excel;charset=utf-8,' + encodeURIComponent(excelFile);
    var link = document.createElement("a");
    link.href = uri;
    link.style = "visibility:hidden";
    link.download = FileName + ".xls";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}